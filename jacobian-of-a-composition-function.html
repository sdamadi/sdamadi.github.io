<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Jacobian matrix of a composite function - Saeed Damadi</title><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://sdamadi.github.io/jacobian-of-a-composition-function.html"><link rel="amphtml" href="https://sdamadi.github.io/amp/jacobian-of-a-composition-function.html"><link type="application/atom+xml" rel="alternate" href="https://sdamadi.github.io/feed.xml"><meta property="og:title" content="Jacobian matrix of a composite function"><meta property="og:site_name" content="My blog - Saeed Damadi"><meta property="og:description" content="This post is the continuation of what I have discussed here to clarify what is Jacobian matrix. We are going to see an example in which Jacobian matrix is being applied on a composite function including two functions. This case is very intuitive since it&hellip;"><meta property="og:url" content="https://sdamadi.github.io/jacobian-of-a-composition-function.html"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Roboto:400,700|Roboto+Condensed:400,700&amp;subset=latin-ext" rel="stylesheet"><link rel="stylesheet" href="https://sdamadi.github.io/assets/css/style.css?v=aa41620c4f80dc7a8874270e3bdddd5b"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://sdamadi.github.io/jacobian-of-a-composition-function.html"},"headline":"Jacobian matrix of a composite function","datePublished":"2019-12-23T17:58","dateModified":"2019-12-25T14:59","description":"This post is the continuation of what I have discussed here to clarify what is Jacobian matrix. We are going to see an example in which Jacobian matrix is being applied on a composite function including two functions. This case is very intuitive since it&hellip;","author":{"@type":"Person","name":"Saeed"},"publisher":{"@type":"Organization","name":"Saeed"}}</script><script async src="https://sdamadi.github.io/assets/js/lazysizes.min.js?v=dc4b666bb3324aea4ead22e26059c761"></script><style>.top__search [type=search] {
						background-image: url(https://sdamadi.github.io/assets/svg/search.svg);
				    }</style><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script></head><body><div class="container"><header class="js-top is-sticky"><a class="logo" href="https://sdamadi.github.io">Saeed Damadi</a><div class="top"><nav class="navbar js-navbar"><button class="navbar__toggle js-navbar__toggle">Menu</button><ul class="navbar__menu"></ul></nav><div class="top__search"><form action="https://sdamadi.github.io/search.html" class="search"><input type="search" name="q" placeholder="search..."></form></div></div></header><main><article class="post"><div class="hero"><header class="hero__text"><h1>Jacobian matrix of a composite function</h1><p class="post__meta"><time datetime="2019-12-23T17:58">December 23, 2019 </time>By <a href="https://sdamadi.github.io/authors/saeed/" rel="author" title="Saeed">Saeed</a></p></header></div><div class="post__entry"><p>This post is the continuation of what I have discussed <a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html">here</a> to clarify what is Jacobian matrix. We are going to see an example in which Jacobian matrix is being applied on a composite function including two functions. This case is very intuitive since it will shed light on the general case. Using what we will find here, the general case will be done.</p><p>Consider $h(x)=f(g(x))$ where $x \in \mathbb{R}^n$, $g:  \mathbb{R}^n \rightarrow  \mathbb{R}^\ell$, and $f:  \mathbb{R}^{\ell} \rightarrow  \mathbb{R}^m$.</p><p>Hence, $$h:  \mathbb{R}^{n} \rightarrow  \mathbb{R}^m$$</p><p>According to what I explained <a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html#mcetoc_1dsr1mght0">here</a>, Jacobian matrix of $h$ is an $m \times n$.</p><p>Also,</p><p>$$<br>J_h(x) = J_f(g(x))J_g(x)<br>$$ </p><p>where $J_g(x)$ is an $\ell \times n$ and $J_f(g(x))$ is an $m \times \ell $ matrix.</p><p><strong>Remark</strong>:</p><ul><li id="1b">$J_g(x)$ is an $\ell \times n$ matrix because it takes an $n$ dimensional vector and maps it to $\ell$ dimensional vector.</li><li>$J_f(g(x))$ is an $m \times \ell$ matrix because its input $g(x)$ is an $\ell$ dimensional vector and the output of $f$ is an $m$ dimensional vector.</li><li id="3b">Since the number of columns of $J_f(g(x))$ is the same as the number of rows of $J_g(x)$  they are comformable and the product is an $m \times n$ matrix.</li><li id="4b">$J_g(x)$ is simply Jacobian matrix of a vector-valued function which was defined in <a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html">the other post</a>.</li><li id="5b">To find $J_f(g(x))$, it is required to have $f$ in terms of each coordinate of $g(x)$ in order to be able to find all the first-order partial derivatives. If $f$ and $g$ are given separately as two functions like $f(z)$ and $g(x)$, to find $J_f(g(x))$ it suffice to find the jacobian of $f$ with respect to $z$ then substitute coordinates of $g(x)$ in as the coordinates of $z$. Precisely, we have $J_f(z) \circ g(x)$.</li><li id="6b">When $h(x)$ is given as a function of $x$, then we are back to the case where Jacobian matrix can be found as the way we found it for a vector-valued fucntion in <a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html">the other post</a>.</li></ul><p>In what follows, I will walk you through what I discussed for the above case. Suppose we are given</p><p>$f\left(u,v\right)=u^{2}+3v^{2}$,</p><p>$g\left(x,y\right)=\begin{bmatrix} e^{x}\cos y  \\ e^{x}\sin y \end{bmatrix} $,</p><p>and the goal is finding the Jacobian matrix of the composite function.  Also, let the composite function be $h$.</p><p><strong>Question: </strong>$h$ is the composite function of $f$ and $g$ or $g$ and $f$?</p><p><strong>Answer: </strong>To clarify the above question, we are required to think of $f$ and $g$ as two mappings where $f: \mathbb{R}^2 \rightarrow \mathbb{R}$ and $g: \mathbb{R}^2 \rightarrow \mathbb{R}^2$.</p><p>Suppose $h = f \circ g$.</p><p>Since $g$ is the last function in the composite function, variables of $h$ are going to be vaibales of $g$. Therefore, $J_h(x, y) = J_f(g(u,v))J_g(x, y)$. <a href="#1b">According to the first and second bullet</a>, $J_f(g(u,v))$ is a $1 \times 2$ matrix and $J_g(x, y)$ is a $2 \times 2$ matrix. Hence, the result is a $1 \times 2$ matrix. However, if we flip $f$ and $g$, and consider $h$ as $h=g \circ f$ and we should have</p><p>$$J_h(u, v) \stackrel{?}{=} J_g(f(u,v))J_f(u, y)$$</p><p>It is easy to see <a href="#1b">from the first bullet</a> that we have a $1 \times 2$ for $J_f(u, v)$ matrix but $J_g(f(x,y))$ is not defind since one should take the derivatives of all coordinates of $g$ with respect to all varibales of $g$ which are now coordinates of $f$; but $f$ is a scalar-valued function and does not output the same dimension as $g$ input needs. In effect, $h=g \circ f$ is not defined. Hence, by compostion function, we mean $h = f \circ g$.</p><p>Let's first compute $J_g(x, y)$ where $g$ is a function of $x,y$ and it is a vector-valued function so</p><p>$$<br>J_g(x, y) = \begin{bmatrix}<br>\frac{\partial g_1}{\partial x} &amp; \frac{\partial g_1}{\partial y} \\<br>\frac{\partial g_2}{\partial x} &amp; \frac{\partial g_2}{\partial y} <br>\end{bmatrix}=<br>\begin{bmatrix}<br>e^x\cos y &amp; -e^x\sin y \\ e^x\sin y &amp; e^x\cos y<br>\end{bmatrix}$$  </p><p>Now to compute $J_f(g(u,v))$ <a href="#5b">using the fifth bullet</a> which yields<br>$$<br>\begin{align}<br>J_f(g(u,v)) &amp;= J_f(z = (u,v))\circ g(x,y)\\<br>&amp;=<br>\begin{bmatrix}<br>\frac{\partial f}{\partial u} &amp; \frac{\partial f}{\partial v}<br>\end{bmatrix} \circ g(x,y) \\<br>&amp;=\begin{bmatrix}<br>2u &amp; 6v<br>\end{bmatrix}\circ g(x,y)\\<br>&amp;=\begin{bmatrix}<br>2u &amp; 6v<br>\end{bmatrix}\circ<br>\begin{bmatrix}<br>e^{x}\cos y \\ e^{x}\sin y<br>\end{bmatrix}\\<br>&amp;=<br>\begin{bmatrix} 2e^{x}\cos y &amp; 6e^{x}\sin y \end{bmatrix}<br>\end{align}<br>$$<br><br>Finally,</p><p>$$<br>\begin{align}<br>J_{h}(x,y) &amp;= J_{f \circ g}(x,y) = J_f(g(u,v)) J_g(x, y)\\<br>&amp;=<br>\begin{bmatrix} 2e^{x}\cos y &amp; 6e^{x}\sin y \end{bmatrix}<br>\begin{bmatrix}<br>e^x\cos y &amp; -e^x\sin y \\ e^x\sin y &amp; e^x\cos y<br>\end{bmatrix}\\<br>&amp;=<br>\begin{bmatrix}<br>2e^{2x}\cos^2y + 6e^{2x}\sin^2y &amp; -2e^{2x}\cos y \sin y + 6e^{2x}\sin y\cos y<br>\end{bmatrix} \\<br>&amp;=<br>2e^{2x}<br>\begin{bmatrix}<br>1 + 2\sin^2y &amp; 2\sin y\cos y<br>\end{bmatrix}<br>\end{align}\\<br>$$</p><p> <strong>Conclusion: </strong>We went through all the steps of finding the Jacobian matrix of a composite function consists of two functions. It is one step left to apply all these result to the lsos function of a neural network.</p><p> </p><p class="post__last-updated">This article was updated on December 25, 2019</p></div><aside class="post__share"></aside><footer class="post__footer"><div class="post__bio"><h3><a href="https://sdamadi.github.io/authors/saeed/" class="inverse" title="Saeed">Saeed</a></h3></div><nav class="post__nav"><div class="post__nav__next">Next Post<h5><a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html" class="inverse" rel="next">What is Jacobian matrix and why do we need it?</a></h5></div></nav><div class="post__related"><h3>Related posts</h3><div class="post__related__wrap"><figure><figcaption><h4><a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html" class="inverse">What is Jacobian matrix and why do we need it?</a></h4><time datetime="2019-12-23T19:02">December 23, 2019</time></figcaption></figure><figure><figcaption><h4><a href="https://sdamadi.github.io/what-is-jacobian-matrix-of-dollarfx-axdollar.html" class="inverse">What is Jacobian matrix of $f(x)&#x3D; Ax$?</a></h4><time datetime="2019-12-25T14:54">December 25, 2019</time></figcaption></figure></div></div></footer></article></main><footer class="footer"><div class="footer__copyright">Powered by Publii</div></footer></div><script defer="defer" src="https://sdamadi.github.io/assets/js/jquery-3.2.1.slim.min.js?v=f307ecc7f6353949f03c06ffa70652a2"></script><script defer="defer" src="https://sdamadi.github.io/assets/js/scripts.min.js?v=f37607af05f83050cdcc37ea18bb5ee1"></script></body></html>