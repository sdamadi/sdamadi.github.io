<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Jacobian matrix of a composition function - Saeed Damadi</title><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://sdamadi.github.io/jacobian-of-a-composition-function.html"><link rel="amphtml" href="https://sdamadi.github.io/amp/jacobian-of-a-composition-function.html"><link type="application/atom+xml" rel="alternate" href="https://sdamadi.github.io/feed.xml"><meta property="og:title" content="Jacobian matrix of a composition function"><meta property="og:site_name" content="My blog - Saeed Damadi"><meta property="og:description" content="This post is the continuation of what I have discussed here to clarify what is Jacobian matrix. We are going to see an example in which Jacobian matrix is being applied on a composition function including two functions. This case is very intuitive since it&hellip;"><meta property="og:url" content="https://sdamadi.github.io/jacobian-of-a-composition-function.html"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Roboto:400,700|Roboto+Condensed:400,700&amp;subset=latin-ext" rel="stylesheet"><link rel="stylesheet" href="https://sdamadi.github.io/assets/css/style.css?v=aa41620c4f80dc7a8874270e3bdddd5b"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://sdamadi.github.io/jacobian-of-a-composition-function.html"},"headline":"Jacobian matrix of a composition function","datePublished":"2019-12-23T17:58","dateModified":"2019-12-23T23:48","description":"This post is the continuation of what I have discussed here to clarify what is Jacobian matrix. We are going to see an example in which Jacobian matrix is being applied on a composition function including two functions. This case is very intuitive since it&hellip;","author":{"@type":"Person","name":"Saeed"},"publisher":{"@type":"Organization","name":"Saeed"}}</script><script async src="https://sdamadi.github.io/assets/js/lazysizes.min.js?v=dc4b666bb3324aea4ead22e26059c761"></script><style>.top__search [type=search] {
						background-image: url(https://sdamadi.github.io/assets/svg/search.svg);
				    }</style><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script></head><body><div class="container"><header class="js-top is-sticky"><a class="logo" href="https://sdamadi.github.io">Saeed Damadi</a><div class="top"><nav class="navbar js-navbar"><button class="navbar__toggle js-navbar__toggle">Menu</button><ul class="navbar__menu"></ul></nav><div class="top__search"><form action="https://sdamadi.github.io/search.html" class="search"><input type="search" name="q" placeholder="search..."></form></div></div></header><main><article class="post"><div class="hero"><header class="hero__text"><h1>Jacobian matrix of a composition function</h1><p class="post__meta"><time datetime="2019-12-23T17:58">December 23, 2019 </time>By <a href="https://sdamadi.github.io/authors/saeed/" rel="author" title="Saeed">Saeed</a></p></header></div><div class="post__entry"><p>This post is the continuation of what I have discussed <a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html">here</a> to clarify what is Jacobian matrix. We are going to see an example in which Jacobian matrix is being applied on a composition function including two functions. This case is very intuitive since it will sheds light on the general case. Using what we will find here, the general case will be done.</p><p>Consider $h(x)=f(g(x))$ where $x \in \mathbb{R}^n$, $g:  \mathbb{R}^n \rightarrow  \mathbb{R}^\ell$, and $f:  \mathbb{R}^{\ell} \rightarrow  \mathbb{R}^m$.</p><p>Hence, $$h:  \mathbb{R}^{n} \rightarrow  \mathbb{R}^m$$.</p><p>According to what I explained <a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html#mcetoc_1dsr1mght0">here</a>, Jacobian matrix of $h$ is an $m \times n$.</p><p>Also,</p><p>$$<br>J_h(x) = J_f(g(x))J_g(x)<br>$$ </p><p>where $J_g(x)$ is an $\ell \times n$ and $J_f(g(x))$ is an $m times \ell $ matrix.</p><p><strong>Remark</strong>:</p><ul><li>$J_g(x)$ is an $\ell \times n$ matrix because it takes an $n$ dimensional vector and maps it to $\ell$ dimensional vector.</li><li>$J_f(g(x))$ is an $m \times \ell$ matrix because its input $g(x)$ is an $\ell$ dimensional vector and the output of $f$ is an $m$ dimensional vector.</li><li>Since the number of columns of $J_f(g(x))$ is the same as the number of rows of $J_g(x)$  they are comformable and the product is an $m \times n$ matrix.</li><li>$J_g(x)$ is simply Jacobian matrix of a vector-valued function which was defined in <a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html">the other post</a>.</li><li>To find $J_f(g(x))$, it is required to have $f$ in terms of each coordinate of $g(x)$ in order to be able to find all the first-order partial derivatives. If $f$ and $g$ are given separately as two functions like $f(z)$ and $g(x)$, to find $J_f(g(x))$ it suffice to find the jacobian of $f$ with respect to $z$ then substitute coordinates of $g(x)$ in as the coordinates of $z$. If we are given $h(x)$ as a function, then we are back to the case where Jacobian matrix can be found as we found it for a vector-valued fucntion in <a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html">the other post</a>.</li></ul><p>In what follows, I will walk you through what I discussed for the above case. Suppose we are given</p><p>$f\left(u,v\right)=u^{2}+3v^{2}$</p><p>and</p><p>$g\left(x,y\right)=\begin{bmatrix} e^{x}\cos y  \\ e^{x}\sin y \end{bmatrix}  $</p><p>Using the chain rule instead:</p><p>\begin{align*}D(f\circ g)(x,y)&amp; =\color{red}{Df(g(x,y))}\cdot\color{blue}{ Dg(x,y)}\\<br>&amp; = \color{red}{\begin{pmatrix} 2u&amp;6v \end{pmatrix}\circ(g(x,y))}\cdot \color{blue}{ \begin{pmatrix}e^x\cos y &amp; -e^x\sin y \\ e^x\sin y &amp; e^x\cos y\end{pmatrix}}\\<br>&amp; =\color{red}{ \begin{pmatrix} 2e^x\cos y&amp;6e^x\sin y \end{pmatrix}}\cdot \color{blue}{ \begin{pmatrix}e^x\cos y &amp; -e^x\sin y \\ e^x\sin y &amp; e^x\cos y\end{pmatrix}}\\<br>\phantom{asd} \\<br>&amp; = \begin{pmatrix}2e^{2x}\cos^2y + 6e^{2x}\sin^2y &amp; -2e^{2x}\cos y \sin y + 6e^{2x}\sin y\cos y \end{pmatrix}\\<br>\phantom{asd} \\<br>&amp; = 2e^{2x}\begin{pmatrix}1 + 2\sin^2y &amp; 2\sin y\cos y \end{pmatrix}<br>\end{align*}</p><p class="post__last-updated">This article was updated on December 23, 2019</p></div><aside class="post__share"></aside><footer class="post__footer"><div class="post__bio"><h3><a href="https://sdamadi.github.io/authors/saeed/" class="inverse" title="Saeed">Saeed</a></h3></div><nav class="post__nav"><div class="post__nav__next">Next Post<h5><a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html" class="inverse" rel="next">What is Jacobian matrix and why do we need it?</a></h5></div></nav><div class="post__related"><h3>Related posts</h3><div class="post__related__wrap"><figure><figcaption><h4><a href="https://sdamadi.github.io/what-is-jacobian-and-why-do-we-need-it.html" class="inverse">What is Jacobian matrix and why do we need it?</a></h4><time datetime="2019-12-23T19:02">December 23, 2019</time></figcaption></figure></div></div></footer></article></main><footer class="footer"><div class="footer__copyright">Powered by Publii</div></footer></div><script defer="defer" src="https://sdamadi.github.io/assets/js/jquery-3.2.1.slim.min.js?v=f307ecc7f6353949f03c06ffa70652a2"></script><script defer="defer" src="https://sdamadi.github.io/assets/js/scripts.min.js?v=f37607af05f83050cdcc37ea18bb5ee1"></script></body></html>